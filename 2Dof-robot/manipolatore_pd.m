function [dxdt] = manipolatore_pd(t,Y,l1,m1,l2,m2,a1_des,a2_des,kp,kd)
g=9.81;
dxdt=[Y(2); -(12*(6*l2^2*m2*(kp*(a1_des-Y(3))-kd*(Y(4))) - 48*l1^2*m2*(kp*(a2_des-Y(1))-kd*(Y(2))) - 16*l1^2*m1*(kp*(a2_des-Y(1))-kd*(Y(2))) - 12*l2^2*m2*(kp*(a2_des-Y(1))-kd*(Y(2))) + 3*g*l2^3*m2^2*cos(Y(1) + Y(3)) + 24*l1*l2*m2*(kp*(a1_des-Y(3))-kd*(Y(4)))*cos(Y(1)) - 48*l1*l2*m2*(kp*(a2_des-Y(1))-kd*(Y(2)))*cos(Y(1)) + 3*l1*l2^3*m2^2*sin(Y(1))*Y(2)^2 + 6*l1*l2^3*m2^2*sin(Y(1))*Y(4)^2 + 24*l1^3*l2*m2^2*sin(Y(1))*Y(4)^2 - 6*g*l1*l2^2*m2^2*cos(Y(3)) + 24*g*l1^2*l2*m2^2*cos(Y(1) + Y(3)) - 24*g*l1^2*l2*m2^2*cos(Y(1))*cos(Y(3)) + 8*g*l1^2*l2*m1*m2*cos(Y(1) + Y(3)) + 12*g*l1*l2^2*m2^2*cos(Y(1))*cos(Y(1) + Y(3)) + 12*l1^2*l2^2*m2^2*cos(Y(1))*sin(Y(1))*Y(2)^2 + 24*l1^2*l2^2*m2^2*cos(Y(1))*sin(Y(1))*Y(4)^2 + 8*l1^3*l2*m1*m2*sin(Y(1))*Y(4)^2 - 3*g*l1*l2^2*m1*m2*cos(Y(3)) + 6*l1*l2^3*m2^2*sin(Y(1))*Y(2)*Y(4) - 12*g*l1^2*l2*m1*m2*cos(Y(1))*cos(Y(3)) + 24*l1^2*l2^2*m2^2*cos(Y(1))*sin(Y(1))*Y(2)*Y(4)))/(l2^2*m2*(64*l1^2*m1 + 192*l1^2*m2 + 48*l2^2*m2 - 144*l1^2*cos(Y(1))^2 - 9*l2^2 - 72*l1*l2*cos(Y(1)) + 192*l1*l2*m2*cos(Y(1)))); Y(4); (12*(16*l2*m2*(kp*(a1_des-Y(3))-kd*(Y(4))) - 24*l1*(kp*(a2_des-Y(1))-kd*(Y(2)))*cos(Y(1)) - 6*l2*(kp*(a2_des-Y(1))-kd*(Y(2))) + 3*g*l2^2*m2*cos(Y(1) + Y(3)) - 8*g*l2^2*m2^2*cos(Y(1) + Y(3)) + 3*l1*l2^2*m2*sin(Y(1))*Y(4)^2 - 16*g*l1*l2*m2^2*cos(Y(3)) + 8*l1*l2^2*m2^2*sin(Y(1))*Y(2)^2 + 12*g*l1*l2*m2*cos(Y(1))*cos(Y(1) + Y(3)) + 12*l1^2*l2*m2*cos(Y(1))*sin(Y(1))*Y(4)^2 - 8*g*l1*l2*m1*m2*cos(Y(3)) + 16*l1*l2^2*m2^2*sin(Y(1))*Y(2)*Y(4)))/(l2*m2*(64*l1^2*m1 + 192*l1^2*m2 + 48*l2^2*m2 - 144*l1^2*cos(Y(1))^2 - 9*l2^2 - 72*l1*l2*cos(Y(1)) + 192*l1*l2*m2*cos(Y(1))))];
end

